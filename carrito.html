<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito - Tienda Virtual</title>
    <link rel="stylesheet" href="style.css">
    <!-- Material Icons para el carrito -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
      body {
        margin: 0;
        background: #f5f5f5;
      }
      .header-dark {
        background: #353535;
        border-bottom: 2px solid #222;
        margin-bottom: 24px;
      }
      .header-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        max-width: 1400px;
        margin: 0 auto;
        padding: 12px 32px;
      }
      .logo img {
        height: 64px;
        border-radius: 8px;
        background: #fff;
      }
      .menu {
        display: flex;
        gap: 40px;
        list-style: none;
        margin: 0 40px 0 40px;
        padding: 0;
      }
      .menu li a {
        color: #fff;
        font-weight: bold;
        font-size: 1.15em;
        text-decoration: none;
        transition: color 0.2s;
      }
      .menu li a:hover {
        color: #ffd600;
      }
      .search-form {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .search-form input[type="text"] {
        padding: 8px 12px;
        border-radius: 6px;
        border: none;
        font-size: 1em;
        width: 200px;
      }
      .search-form button {
        padding: 8px 16px;
        border-radius: 6px;
        border: none;
        background: #444;
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        transition: background 0.2s;
      }
      .search-form button:hover {
        background: #1976d2;
      }
      .carrito-icono {
        position: relative;
        margin-left: 24px;
      }
      .carrito-contador {
        position: absolute;
        top: -8px;
        right: -12px;
        background: #f00;
        color: #fff;
        border-radius: 50%;
        font-size: 0.95em;
        padding: 2px 8px;
        font-weight: bold;
      }
      /* Productos en el carrito */
      .panel-producto-carrito {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        margin-bottom: 18px;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        background: #fff;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        transition: box-shadow 0.2s;
      }
      .panel-producto-carrito:hover {
        box-shadow: 0 4px 16px rgba(0,0,0,0.10);
      }
      .panel-producto-carrito img {
        width: 90px;
        height: 90px;
        object-fit: contain;
        border-radius: 8px;
        border: 1px solid #eee;
        background: #f9f9f9;
      }
      .panel-producto-carrito .info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .panel-producto-carrito .nombre {
        font-weight: bold;
        font-size: 1.15em;
        color: #1a237e;
      }
      .panel-producto-carrito .descripcion {
        font-size: 0.98em;
        color: #555;
      }
      .panel-producto-carrito .precio {
        color: #2d8f2d;
        font-size: 1.1em;
        font-weight: bold;
      }
      .panel-producto-carrito button {
        padding: 7px 14px;
        border: none;
        border-radius: 5px;
        font-size: 1em;
        cursor: pointer;
        margin-left: 4px;
        transition: background 0.2s, color 0.2s;
      }
      .panel-producto-carrito button:first-of-type {
        background: #1976d2;
        color: #fff;
      }
      .panel-producto-carrito button:last-of-type {
        background: #e74c3c;
        color: #fff;
      }
      #total {
        margin-top: 30px;
        text-align: right;
        font-size: 1.2em;
        font-weight: bold;
        color: #1a237e;
      }
      /* Nueva sección para el menú superior */
      .menu-superior {
        position: fixed;
        top: 0;
        width: 100%;
        background: #172a7c;
        color: #fff;
        z-index: 1000;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0;
      }
      .menu-superior .logo {
        display: flex;
        align-items: center;
        margin-left: 32px;
      }
      .menu-superior .logo img {
        height: 48px;
        margin-right: 32px;
        border-radius: 12px;
      }
      .menu-superior nav {
        flex: 1;
      }
      .menu-superior nav ul {
        display: flex;
        gap: 38px;
        list-style: none;
        margin: 0;
        padding: 0;
        justify-content: center;
      }
      .menu-superior nav ul li a {
        color: #fff;
        text-decoration: none;
        font-weight: bold;
        font-size: 16px;
        transition: color 0.2s;
      }
      .menu-superior nav ul li a:hover {
        color: #25d366;
      }
      .barra-busqueda {
        display: flex;
        align-items: center;
        gap: 18px;
        margin-right: 32px;
      }
      .barra-busqueda input {
        padding: 5px 10px;
        border-radius: 3px;
        border: none;
        font-size: 15px;
      }
      .barra-busqueda button {
        background: #666;
        color: #fff;
        border: none;
        padding: 5px 12px;
        border-radius: 3px;
        cursor: pointer;
        font-size: 15px;
      }
      .carrito {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .carrito-icono {
        font-size: 20px;
      }
      .contador {
        font-size: 13px;
        background: red;
        color: #fff;
        border-radius: 50%;
        padding: 5px 10px;
        font-weight: bold;
      }
      main {
        padding-top: 100px;
      }
      @media (max-width: 900px) {
        .header-container {
          flex-direction: column;
          gap: 12px;
          padding: 12px 8px;
        }
        .menu {
          gap: 18px;
          margin: 0;
        }
        .search-form input[type="text"] {
          width: 120px;
        }
      }
      @media (max-width: 600px) {
        .panel-producto-carrito {
          flex-direction: column;
          align-items: flex-start;
        }
        .panel-producto-carrito img {
          width: 100%;
          height: auto;
        }
        #total {
          text-align: left;
        }
        .logo img {
          height: 40px;
        }
      }
    </style>
</head>
<body>
  <!-- Banner  -->
  <div class="menu-superior" style="background: #172a7c; color: #fff; padding: 0;">
    <div class="logo" style="display: flex; align-items: center; margin-left: 32px;">
      <img src="https://media.licdn.com/dms/image/v2/D4E0BAQGzyLtzNxAmVQ/company-logo_200_200/company-logo_200_200/0/1706325237530/instituto_tecnologico_de_cancn_logo?e=2147483647&v=beta&t=lTklKP8Ih95EBR21RQvI1lgtFT0OKJJIfJZuHsY92aI" alt="Logo Tienda Virtual" style="height: 48px; margin-right: 32px; border-radius: 12px;">
    </div>
    <nav style="flex:1;">
      <ul style="display: flex; gap: 38px; list-style: none; margin: 0; padding: 0; justify-content: center;">
        <li><a href="index.html" style="color: #fff; text-decoration: none; font-weight: bold; font-size: 16px;">Inicio</a></li>
        <li><a href="quienes-somos.html" style="color: #fff; text-decoration: none; font-size: 16px;">Quiénes Somos</a></li>
        <li><a href="#contacto" style="color: #fff; text-decoration: none; font-size: 16px;">Contacto</a></li>
        <li><a href="FAQ.html" style="color: #fff; text-decoration: none; font-size: 16px;">FAQ</a></li>
        <li class="testimonios-link" style="margin-left: 0;"><a href="#testimonios-link" style="color: #fff; text-decoration: none; font-size: 16px;">Testimonios</a></li>
      </ul>
    </nav>
    <div class="barra-busqueda" style="display: flex; align-items: center; gap: 18px; margin-right: 32px;">
      <input type="text" placeholder="Buscar productos..." id="busqueda-carrito" onkeydown="if(event.key==='Enter'){buscarProductoCarrito();return false;}" style="padding: 5px 10px; border-radius: 3px; border: none; font-size: 15px;">
      <button onclick="buscarProductoCarrito()" style="background: #666; color: #fff; border: none; padding: 5px 12px; border-radius: 3px; cursor: pointer; font-size: 15px;">Buscar</button>
      <span id="nombre-usuario" style="font-weight:bold; cursor:pointer; text-decoration:underline; font-size:15px;"></span>
      <button id="cerrar-sesion-btn" style="background:#e74c3c; color:#fff; border:none; border-radius:4px; padding:7px 12px; cursor:pointer; font-size:14px; display:none;">Cerrar sesión</button>
      <div class="carrito" onclick="window.location.href='carrito.html'">
        <span class="carrito-icono material-icons" style="font-size:20px;">shopping_cart</span>
        <span class="contador" id="contadorCarrito" style="font-size:13px;">0</span>
      </div>
    </div>
  </div>

    <main>
      <h2>Productos en tu carrito</h2>
      <section id="productosCarrito">
          <!-- Aquí se agregarán los productos dinámicamente con JavaScript -->
      </section>
      <div id="total">
          <h3>Total: $<span id="totalPrecio">0.00</span></h3>
      </div>
      <button onclick="location.href='checkout.html'" style="margin-top:20px;padding:10px 24px;font-size:1.1em;background:#1976d2;color:#fff;border:none;border-radius:6px;cursor:pointer;">Ir al Checkout</button>
    </main>
    <script>
  // Mostrar nombre de usuario y botón de cerrar sesión (igual que en index)
  function mostrarNombreUsuario() {
    const usuario = JSON.parse(localStorage.getItem('usuarioLogueado'));
    const nombreSpan = document.getElementById('nombre-usuario');
    const cerrarBtn = document.getElementById('cerrar-sesion-btn');
    if (usuario && usuario.nombre) {
      nombreSpan.textContent = "Hola, " + usuario.nombre;
      cerrarBtn.style.display = "inline-block";
      nombreSpan.onclick = function() {
        window.location.href = "user.html";
      };
    } else {
      nombreSpan.textContent = "";
      cerrarBtn.style.display = "none";
      nombreSpan.onclick = null;
    }
  }
  mostrarNombreUsuario();

  document.getElementById('cerrar-sesion-btn').onclick = function() {
    localStorage.removeItem('isLoggedIn');
    localStorage.removeItem('usuarioLogueado');
    window.location.href = "login.html";
  };

  // Cargar productos del carrito
  function mostrarCarrito() {
    const productosCarrito = document.getElementById('productosCarrito');
    const totalPrecio = document.getElementById('totalPrecio');
    const contadorCarrito = document.getElementById('contadorCarrito');
    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    productosCarrito.innerHTML = '';
    let total = 0;

    carrito.forEach((producto, index) => {
      total += parseFloat(producto.precio);
      productosCarrito.innerHTML += `
        <div class="panel-producto-carrito">
          <img src="${producto.imagen}" alt="${producto.nombre}">
          <div class="info">
            <div class="nombre">${producto.nombre}</div>
            <div class="descripcion">${producto.descripcion ? producto.descripcion : ''}</div>
            <div class="precio">$${parseFloat(producto.precio).toFixed(2)}</div>
          </div>
          <button onclick="agregarUno(${index})">Agregar</button>
          <button onclick="eliminarDelCarrito(${index})">Eliminar</button>
        </div>
      `;
    });

    totalPrecio.textContent = total.toFixed(2);
    contadorCarrito.textContent = carrito.length;
  }

  function agregarUno(index) {
    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    const producto = carrito[index];
    carrito.push(producto); // Agrega otra unidad igual
    localStorage.setItem('carrito', JSON.stringify(carrito));
    mostrarCarrito();
  }

  function eliminarDelCarrito(index) {
    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    carrito.splice(index, 1); // Elimina el producto en esa posición
    localStorage.setItem('carrito', JSON.stringify(carrito));
    mostrarCarrito();
  }

  // Buscar productos en el carrito
  function buscarProductoCarrito() {
    const termino = document.getElementById("busqueda-carrito").value.toLowerCase();
    document.querySelectorAll("#productosCarrito .panel-producto-carrito").forEach(producto => {
      const texto = producto.textContent.toLowerCase();
      producto.style.display = texto.includes(termino) ? "flex" : "none";
    });
  }

  // Mostrar el carrito al cargar la página
  mostrarCarrito();
</script>
</body>
</html>
